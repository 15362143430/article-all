<div id="article_content" class="article_content clearfix">
                                                <div class="article-copyright">
                <span class="creativecommons">
                <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
                    </a>
            <span><a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank"></span>
               <div class="article-source-link2222">
                    <a href="https://blog.csdn.net/qq_28004379/article/details/80409821"></a>
                </div>
            </span>
                    </div>
                                                    <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
                                        <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
                <div class="htmledit_views" id="content_views">
                                            <p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span style="font-family:'Microsoft YaHei';font-size:14px;">如果你是前端想步入全栈领域，如果你想用Node做一个接口，如果你想自己操作一下数据库连接到自己页面的冲动，本篇会大大帮助你，让你一步一步跨过阻碍，到达全栈的第一脚。</span></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">大概流程：</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">一：安装：mongodb数据库</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">&nbsp; &nbsp; &nbsp; &nbsp;安装：Node与express</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">二：服务器连接数据库</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">三：前后端调用</span></span></p><h1><a name="t0"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:24px;">一：安装</span></span></h1><h2><a name="t1"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:18px;">1.1Mongodb</span></span></h2><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">Mongodb官网地址：<a href="https://www.mongodb.com/download-center?jmp=nav#community" rel="nofollow" data-token="d16476894ea9686e73ec6686507a9cca">https://www.mongodb.com/download-center?jmp=nav#community</a></span></span></p><h3><a name="t2"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;">1.1.1安装Mongodb</span></span></h3><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180522185034331?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">选择自己系统然后下载之后运行</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180522185135420?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180522185154120?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180522185216484?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180522185255316?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><h3><a name="t3"></a><span style="color:rgb(51,51,51);"><span style="background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;">1.1.2<span style="border:0px;margin:0px;padding:0px;color:rgb(51,51,51);background-color:rgb(255,255,255);">创建数据目录</span></span></span></span></span></h3><p style="border:0px;margin-bottom:0px;line-height:2em;background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span style="color:#333333;">MongoDB将数据目录存储在 db 目录下。但是这个</span><span style="color:#ff0000;">数据目录不会主动创建，我们在安装完成后需要创建它【就是手动创建一个文件夹】</span><span style="color:#333333;">。</span></span></span></p><p style="border:0px;margin-bottom:0px;line-height:2em;background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span style="color:#333333;">【注意：</span><span style="color:rgb(51,51,51);background-color:rgb(255,255,255);">如果出现后面出现错误，则把</span><span style="color:rgb(51,51,51);background-color:rgb(255,255,255);">数据目录应该放在根目录下（(如： C:\ 或者 D:\ 等 )。</span><span style="color:#333333;">】</span></span></span></p><h3><a name="t4"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;">1.1.3 命令行运行MongoDB服务器</span></span></h3><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">打开cmd：输入一下格式</span></span></p><pre class="prettyprint prettyprinted" style="border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);margin:15px auto;padding:10px 15px;white-space:pre-wrap;background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;color:rgb(51,51,51);" name="code"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span class="pln" style="border:0px;margin:0px;padding:0px;color:rgb(0,0,0);">mongodb的bin路径&gt;mongod </span><span class="pun" style="border:0px;margin:0px;padding:0px;color:rgb(102,102,0);">--</span><span class="pln" style="border:0px;margin:0px;padding:0px;color:rgb(0,0,0);">dbpath 数据目录</span></span></span></pre><h2 style="border:0px;margin-top:2px;margin-bottom:2px;padding:0px;line-height:1.8em;color:rgb(51,51,51);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180522190755266?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></h2><h3><a name="t6"></a><span style="color:rgb(51,51,51);"><span style="background-color:rgb(255,255,255);"><span style="border:0px;margin:0px;padding:0px;color:rgb(51,51,51);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;">1.1.4 打开可视化工具连接（Robomongo）</span></span></span></span></span></h3><p>有很多可视化工具，看自己的爱好~~</p><p><span style="color:rgb(51,51,51);"><span style="background-color:rgb(255,255,255);"><span style="border:0px;margin:0px;padding:0px;color:rgb(51,51,51);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180522191242862?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></span></span></span></p><p><span style="color:rgb(51,51,51);"><span style="background-color:rgb(255,255,255);"><span style="border:0px;margin:0px;padding:0px;color:rgb(51,51,51);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">此时数据库已经完毕了~~~</span></span></span></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">其他系统安装或者更详细安装您可以在下面链接看看：</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">【链接一：<a href="http://www.imooc.com/article/18438" rel="nofollow" data-token="bfe96b4d6d4b7511af48d36c69f8d270">http://www.imooc.com/article/18438</a>】</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">【链接二：<a href="http://www.runoob.com/mongodb/mongodb-window-install.html" rel="nofollow" data-token="3b7b3eb77543224e8603b79823856c4d">http://www.runoob.com/mongodb/mongodb-window-install.html</a>】<br></span></span></p><h2><a name="t7"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:18px;">1.2 node和express</span></span></h2><h3><a name="t8"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;">1.2.1 node与express的安装</span></span></h3><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span style="color:#000000;background-color:rgb(102,255,153);">node安装</span>就不说了网上一大堆，给个链接不会的看看就懂了</span></span></p><p style="text-align:justify;"><span style="font-family:'Microsoft YaHei';text-align:left;"><a href="http://note.youdao.com/noteshare?id=c1abd19bbe12e12522d61f5867751a9a&amp;sub=0C8B4FA7214F4D1383446EDD1952374E" rel="nofollow" data-token="1a23f673bee66b59a5c52bbdf2ceb8b0"><span style="font-size:14px;">http://note.youdao.com/noteshareid</span></a></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span style="background-color:rgb(102,255,153);">express安装</span>使用npm</span></span></p><pre><code class="hljs java">npm i -g express generator  <span class="hljs-comment">//全局安装【jade模板】</span></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">安装完成之后查看是否安装成功</span></span></p><pre><code class="hljs java">express  --version <span class="hljs-comment">//查看版本号</span></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523090947411?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"></span></span><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">【安装出现问题可以看看这个：<a href="https://www.jianshu.com/p/32fd5ff28678" rel="nofollow" data-token="174694e3a35f24c23d9041b2d22c154c">https://www.jianshu.com/p/32fd5ff28678</a>】<u><span style="color:rgb(0,0,255);"></span></u></span></span></p><h3><a name="t9"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;">1.2.2 新建一个express项目</span></span></h3><pre><code class="hljs">自动创建项目：express +名字</code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523091314166?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"></span></span></p><pre><code class="hljs sql">npm <span class="hljs-keyword">install</span> 安装依赖</code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523091725738?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"></span></span></p><pre><code class="hljs sql">npm <span class="hljs-keyword">start</span> 或者 node <span class="hljs-keyword">bin</span>/www   启动express</code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523092110956?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"></span></span></p><p><span style="font-family:'Microsoft YaHei';background-color:rgb(153,255,255);"><span style="font-size:14px;">浏览器打开http://localhost:3000/</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523092136329?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">此时已经express已经成功了，开心不~~~</span></span></p><h3><a name="t10"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;">1.2.3 express项目目录介绍</span></span></h3><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523092906198?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><h3><a name="t11"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:16px;">1.2.4 设置模板引擎&nbsp;</span></span></h3><p>看自己擅长那个，那个顺手用哪个，不过官方推荐的还是jade，多学一学没坏处的~~</p><p><span style="background-color:rgb(204,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">默认是jade</span></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523093233884?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">想使用：<span style="background-color:rgb(204,255,255);">ejs模板引擎配置</span></span></span></p><p><span style="color:rgb(47,47,47);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">命令行安装：</span></span></span></p><pre><code class="hljs sql">npm <span class="hljs-keyword">install</span> ejs-mate <span class="hljs-comment">--save</span></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">在<span style="background-color:rgb(255,204,204);">app.js中修改</span>如下代码</span></span></p><pre><code class="hljs cs"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">var</span> engine = require(<span class="hljs-string">'ejs-mate'</span>);<span class="hljs-comment">//添加引用</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">app.<span class="hljs-keyword">set</span>(<span class="hljs-string">'views'</span>, path.<span class="hljs-keyword">join</span>(__dirname, <span class="hljs-string">'views'</span>));<span class="hljs-comment">//在app.js中找到这个行</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">app.<span class="hljs-keyword">set</span>(<span class="hljs-string">'view engine'</span>, <span class="hljs-string">'ejs'</span>);<span class="hljs-comment">//修改jade为ejs</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">app.engine(<span class="hljs-string">'ejs'</span>, engine);<span class="hljs-comment">//添加这行</span></div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">此时就可以把view文件夹下的文件删除，创建自己的XX.ejs文件</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523093840263?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">想使用：<span style="background-color:rgb(204,255,255);">HTML模板引擎配置</span></span></span></p><p><span style="color:rgb(47,47,47);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">命令行安装：</span></span></span></p><pre><code class="hljs sql">npm <span class="hljs-keyword">install</span> ejs <span class="hljs-comment">--save</span></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">在app.js中修改如下代码</span></span></p><pre><code class="hljs cs"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">var</span> ejs=require(<span class="hljs-string">'ejs'</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">app.<span class="hljs-keyword">set</span>(<span class="hljs-string">'views'</span>, path.<span class="hljs-keyword">join</span>(__dirname, <span class="hljs-string">'views'</span>));</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">app.engine(<span class="hljs-string">'html'</span>,ejs.__express);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">app.<span class="hljs-keyword">set</span>(<span class="hljs-string">'view engine'</span>, <span class="hljs-string">'html'</span>);</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">此时就可以把view文件夹下面文件删除，创建自己的XX.html文件</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523093820503?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">如果想知道为什么这么做呢？你可在链接中看看【<a href="https://www.cnblogs.com/-nothing-/p/4943354.html" rel="nofollow" data-token="02e607a69d251a2fa99eebd3558899fb">https://www.cnblogs.com/-nothing-/p/4943354.html</a>】</span></span></p><h1><a name="t12"></a><span style="font-family:'Microsoft YaHei';"><span style="font-size:24px;">二：服务器连接数据库</span></span></h1><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">首先：打开自己的服务器。【<span style="background-color:rgb(255,204,204);">必须要打开，必须要打开，必须要打开！！！</span>】</span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;">打开mongodb还记得吗？</span></span></p><pre class="prettyprint prettyprinted" style="margin:15px auto;padding:10px 15px;background:rgb(251,251,251) url(&quot;/images/codecolorer_bg.gif&quot;) center top;color:rgb(51,51,51);border-width:1px 1px 1px 4px;border-style:solid;border-color:rgb(221,221,221);white-space:pre-wrap;" name="code"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span class="pln" style="border:0px;margin:0px;padding:0px;color:rgb(0,0,0);">mongodb的bin路径&gt;mongod </span><span class="pun" style="border:0px;margin:0px;padding:0px;color:rgb(102,102,0);">--</span><span class="pln" style="border:0px;margin:0px;padding:0px;color:rgb(0,0,0);">dbpath 数据目录</span></span></span></pre><p><span><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span style="color:#2f2f2f;background-color:rgb(255,255,255);">在自己</span><span style="color:#000000;background-color:rgb(153,255,153);">新建的express项目目录根文件路径</span><span style="color:#2f2f2f;background-color:rgb(255,255,255);">下</span><span style="color:rgb(47,47,47);background-color:rgb(255,204,204);">安装<span style="color:rgb(47,47,47);">Mongoose</span></span></span></span></span></p><pre><code class="hljs sql">npm <span class="hljs-keyword">install</span> mongoose <span class="hljs-comment">--save</span></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="color:rgb(47,47,47);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span style="background-color:rgb(255,255,255);">在自己刚刚创建的项目(express)</span><span style="background-color:rgb(255,204,204);">文件夹根目录上，新建db.js</span><span style="background-color:rgb(255,255,255);">，内容：</span></span></span></span></p><pre><code class="hljs javascript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">var</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mongoose"</span>); <span class="hljs-comment">//引入mongoose</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">mongoose.connect(<span class="hljs-string">'mongodb://localhost/list'</span>); <span class="hljs-comment">//连接到mongoDB的todo数据库</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-comment">//该地址格式：mongodb://[username:password@]host:port/database[?options]</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-comment">//默认port为27017 </span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">var</span> db = mongoose.connection;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">db.on(<span class="hljs-string">'error'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callback</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-comment">//监听是否有异常</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Connection error"</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">});</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">db.once(<span class="hljs-string">'open'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callback</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-comment">//监听一次打开</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-comment">//在这里创建你的模式和模型</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'connected!'</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">});</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-built_in">module</span>.exports = mongoose;</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><br><p><span style="color:rgb(47,47,47);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span style="background-color:rgb(255,255,255);">在app.js</span><span style="background-color:rgb(255,204,204);">最前面引入</span><span style="background-color:rgb(255,255,255);">【就是第一句！！】</span></span></span></span></p><pre><code class="hljs javascript"><span class="hljs-built_in">require</span>(<span class="hljs-string">'./db'</span>);</code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><span style="color:rgb(47,47,47);background-color:rgb(255,255,255);">然后就可以</span><span style="color:rgb(47,47,47);background-color:rgb(255,255,255);">试试，是否连接成功？</span></span></span></p><pre><code class="hljs sql">npm <span class="hljs-keyword">start</span></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="color:rgb(47,47,47);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180523095204808?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></span></span></p><h1><a name="t13"></a><span style="color:rgb(47,47,47);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';font-size:24px;">三：写接口、页面联调</span></span></h1><h2><a name="t14"></a><span style="font-size:18px;">3.1 理解<span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">mongoose的属性、模型</span></span></h2><p style="margin:10px auto;font-family:'微软雅黑', PTSans, Arial, sans-serif;text-align:left;color:rgb(0,0,0);"><span style="font-size:14px;"><span style="background-color:rgb(255,204,204);"><strong>Schema (<span style="color:rgb(0,0,0);font-family:'微软雅黑', PTSans, Arial, sans-serif;text-align:left;">属性</span>)</strong></span><span style="background-color:rgb(255,255,255);">：在Mongoose里一切都是从Schema开始的，每一个Schema都会映射到MongoDB的一个collection上。Schema定义了collection里documents的模板（或者说是框架）。【</span><span style="background-color:rgb(255,255,255);color:rgb(47,47,47);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif;text-align:left;">一种以文件形式存储的数据库模型骨架，不具备数据库的操作能力</span><span style="background-color:rgb(255,255,255);">】</span></span></p><pre><code class="hljs javascript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">var</span> blogSchema = <span class="hljs-keyword">new</span> Schema({ <span class="hljs-comment">// Schema头字母大写，因为Schema是构造函数</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  title:  <span class="hljs-built_in">String</span>,</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-attr">comments</span>: [{ <span class="hljs-attr">body</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">date</span>: <span class="hljs-built_in">Date</span> }], <span class="hljs-comment">// 对象数组</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  date: { <span class="hljs-attr">type</span>: <span class="hljs-built_in">Date</span>, <span class="hljs-attr">default</span>: <span class="hljs-built_in">Date</span>.now }, <span class="hljs-comment">// 通过default设置默认值</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  hidden: <span class="hljs-built_in">Boolean</span>,</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-attr">meta</span>: { <span class="hljs-comment">// 嵌套对象</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    votes: <span class="hljs-built_in">Number</span>,</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-attr">favs</span>:  <span class="hljs-built_in">Number</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  }</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">});</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><br><p><span style="font-size:14px;"><span style="background-color:rgb(255,204,204);"><strong>model (<span style="color:rgb(47,47,47);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif;text-align:left;">模型)</span></strong></span>：为了使用定义好的Schema，我们需要把blogSchema转换成我们可以使用的model(其实是把Schema编译成model，所以对于Schema的一切定义都要在compile之前完成)。也就是说model才是我们可以进行操作的handle。</span></p><pre><code class="hljs go"><span class="hljs-keyword">var</span> Blog = mongoose.model(<span class="hljs-string">'Blog'</span>, blogSchema);<span class="hljs-comment">//编译model</span></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-size:14px;">这样我们就获得了一个名为Blog的model了。生成model的同时MongoDB中对应的collection也被建立了，model的名字是Blog，而collection的名字被默认是model名字的复数也就是blogs（细心的小伙伴会发现不止变复数了，而且字母全部变小写了，亲测是这样的）。【<span style="color:rgb(47,47,47);font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif;text-align:left;background-color:rgb(255,255,255);">由Schema发布生成的模型，具有抽象属性和行为的数据库操作对</span>】</span></p><p style="margin:10px auto;font-family:'微软雅黑', PTSans, Arial, sans-serif;text-align:left;"><span style="font-size:14px;"><span style="background-color:rgb(255,255,204);"><span style="color:#000000;"><strong>　</strong></span></span><span style="margin:0px;padding:0px;"><span style="margin:0px;padding:0px;background-color:rgb(255,255,204);"><span style="color:#000000;"><strong>Schema和model的理解</strong></span></span><br style="margin:0px;padding:0px;"></span></span></p><p style="margin:10px auto;color:rgb(0,0,0);font-family:'微软雅黑', PTSans, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);"><span style="font-size:14px;"><span style="margin:0px;padding:0px;">　　</span>不同于关系型数据库，MongoDB作为文档型数据库，Scheme、model、collection、document是其中的四大元素。document是MongoDB里的基本存储单位，collection是众多同类document的集合。Schema定义了一类document的模板，让这一类document在数据库中有一个具体的构成、存储模式。而Schema仅仅是定义了Document是什么样子的，至于生成document和对document进行各种操作（增删改查）则是通过相对应的model来进行的。</span></p><p style="margin:10px auto;color:rgb(0,0,0);font-family:'微软雅黑', PTSans, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);"><span style="font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;需要说明的是MongoDB中实际上只有collection和document，Schema和model不过是定义和生成前二者过程中的工具而已。</span></p><h2><a name="t15"></a><span style="color:rgb(47,47,47);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:18px;">3.2 自己定义属性和模型</span></span></span></h2><p><span style="font-size:14px;">在db.js中加入</span></p><pre><code class="hljs javascript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">var</span> ListSchema = <span class="hljs-keyword">new</span> mongoose.Schema({</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-attr">user_id</span>: <span class="hljs-built_in">String</span>, <span class="hljs-comment">//定义一个属性user_id，类型为String</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    content: <span class="hljs-built_in">String</span>, <span class="hljs-comment">//定义一个属性content，类型为String</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    updated_at: <span class="hljs-built_in">Date</span> <span class="hljs-comment">//定义一个属性updated_at，类型为Date</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">});</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">mongoose.model(<span class="hljs-string">'user'</span>, ListSchema); <span class="hljs-comment">//将该Schema发布为Model,user就是集合名称</span></div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><h2><a name="t16"></a><span style="color:rgb(47,47,47);background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';"><span style="font-size:18px;">3.3 开始做出自己的接口了</span></span></span></h2><p><span style="font-size:14px;"><span style="background-color:rgb(255,204,204);">首先在routes/index.js中添加引用</span></span></p><pre><code class="hljs javascript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">var</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>); <span class="hljs-comment">//引入对象</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">var</span> TodoModel = mongoose.model(<span class="hljs-string">'user'</span>);<span class="hljs-comment">//引入模型</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">var</span> URL = <span class="hljs-built_in">require</span>(<span class="hljs-string">'url'</span>); <span class="hljs-comment">//引入URL中间件，获取req中的参数需要</span></div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><h3><a name="t17"></a><span style="font-size:16px;">3.3.1 新增接口</span></h3><p><span style="font-size:14px;">修改views/index.html</span></p><pre><code class="hljs javascript"><ol class="hljs-ln" style="width:1015px"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  &lt;form <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"initform"</span> method=<span class="hljs-string">"post"</span> accept-charset=<span class="hljs-string">"utf-8"</span>&gt;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"from-group"</span>&gt;</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>输入内容<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control createContent"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"content"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Enter Todo"</span> /&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"from-group"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin: 10px 0px;"</span>&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-info"</span> ο<span class="hljs-attr">nclick</span>=<span class="hljs-string">"ceateItem()"</span>&gt;</span>新增<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><pre><code class="hljs xml"><ol class="hljs-ln" style="width:713px"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-comment">//创建数据</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ceateItem</span>(<span class="hljs-params"></span>) </span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-keyword">var</span> obj = {};</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            obj.content = $(<span class="hljs-string">'.createContent'</span>).val();</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-keyword">if</span> (obj.content != <span class="hljs-string">''</span>) {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                $.post(<span class="hljs-string">'http://localhost:3000/create'</span>, obj, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'新增成功'</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                    searchItem();</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                })</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            } <span class="hljs-keyword">else</span> {</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                alert(<span class="hljs-string">'不能为空'</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            }</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        }</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-size:14px;">修改routes/index.js</span></p><pre><code class="hljs javascript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">router.post(<span class="hljs-string">'/create'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'req.body'</span>, req.body);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-keyword">new</span> TodoModel({ <span class="hljs-comment">//实例化对象，新建数据</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">      content: req.body.content,</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">      <span class="hljs-attr">updated_at</span>: <span class="hljs-built_in">Date</span>.now()</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  }).save(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, todo, count</span>) </span>{ <span class="hljs-comment">//保存数据</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'内容'</span>, todo, <span class="hljs-string">'数量'</span>, count); <span class="hljs-comment">//打印保存的数据</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">      res.redirect(<span class="hljs-string">'/'</span>); <span class="hljs-comment">//返回首页</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  });</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">});</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><h3><a name="t18"></a><span style="font-size:16px;">3.3.2 查询接口</span></h3><p><span style="font-size:14px;">修改views/index.html</span></p><p><span style="font-size:14px;">修改routes/index.js</span></p><pre><code class="hljs javascript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">router.get(<span class="hljs-string">'/search'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>) </span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  TodoModel.</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  find().</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  sort(<span class="hljs-string">'updated_at'</span>).</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  exec(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, aa, count</span>) </span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    res.send(aa);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  });</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">});</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><p><span style="font-size:14px;">保存之后，此时启动服务看看效果--npm start ----http://localhost:3000/</span></p><p><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180524094601363?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></p><p><span style="font-size:14px;">页面网络请求如下：</span></p><p><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180524094820219?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></p><p><span style="font-size:14px;">数据库显示如下：</span></p><p><span style="font-size:14px;"><img src="https://img-blog.csdn.net/20180524095032739?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4MDA0Mzc5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="显示不出来"><br></span></p><p><span style="font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;为了好看我引入一下bootstrap，其实也页面都是很常用的ajax请求，布局怎么显示就看你怎么设计了，主要就是routes/index.js的获取请求已经处理。咱们继续一口气把编辑保存和删除写了</span></p><h3><a name="t19"></a><span style="font-size:16px;">3.3.3 编辑保存--【先找到需要编辑的数据，然后保存】</span></h3><p><span style="font-size:14px;">修改routes/index.js</span></p><pre><code class="hljs javascript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">router.get(<span class="hljs-string">'/edit'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req,res</span>)</span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-keyword">var</span> params=URL.parse(req.url,<span class="hljs-literal">true</span>).query;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-comment">//res.send(params);</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  TodoModel.findById(params.id,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,todo</span>)</span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">   <span class="hljs-comment">// res.redirect('edit'); //返回首页</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    res.send(todo);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  })</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">})</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">router.post(<span class="hljs-string">'/update'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req,res</span>)</span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-comment">//res.send(req);</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-built_in">console</span>.log(req.body);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  TodoModel.findById(req.body._id,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,todo</span>)</span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    todo.content=req.body.content;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    todo.updated_at=<span class="hljs-built_in">Date</span>.now();</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    todo.save();</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  })</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> res.redirect(<span class="hljs-string">'/'</span>); <span class="hljs-comment">//返回首页</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">})</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><br><h3><a name="t20"></a><span style="font-size:16px;">3.3.4 删除数据</span></h3><pre><code class="hljs javascript"><ol class="hljs-ln"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">router.get(<span class="hljs-string">'/destroy'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req,res</span>)</span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-keyword">var</span> params=URL.parse(req.url,<span class="hljs-literal">true</span>).query;</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  <span class="hljs-built_in">console</span>.log(params);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-comment">//根据待办事项的id 来删除它</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    TodoModel.findById(params.id, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, todo</span>) </span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">      todo.remove(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, todo</span>) </span>{</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">          res.redirect(<span class="hljs-string">'/'</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">      });</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  });</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">})</div></div></li></ol></code><div class="hljs-button {2}" data-title="复制" onclick="hljs.copyCode(event)"></div></pre><span style="font-size:14px;">~<br><br></span><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><br></span></span></p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><br><br><br></span></span><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><br></span></span></p><p><span style="font-family:'Microsoft YaHei';"><span style="font-size:14px;"><br></span></span></p><p><br></p>                                    </div>
                    </div>